<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Functional Regression Test</title>
    <!-- Adaptive favicon for light/dark mode -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-container {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-result {
            padding: 10px;
            margin: 5px 0;
            border-radius: 4px;
            font-weight: bold;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .warning {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        .test-button {
            display: inline-block;
            margin: 5px;
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            text-decoration: none;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        .test-button:hover {
            background-color: #0056b3;
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .feature-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            background: #f8f9fa;
        }
        .feature-card h4 {
            margin: 0 0 10px 0;
            color: #333;
        }
        .test-link {
            display: block;
            margin: 5px 0;
            padding: 8px 12px;
            background: #28a745;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            font-size: 13px;
            text-align: center;
        }
        .test-link:hover {
            background: #1e7e34;
        }
        .auth-required {
            background: #ffc107;
            color: #212529;
        }
        .auth-required:hover {
            background: #e0a800;
        }
        .checklist {
            list-style: none;
            padding: 0;
        }
        .checklist li {
            margin: 8px 0;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 4px;
            border-left: 4px solid #007bff;
        }
        .checklist input[type="checkbox"] {
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <h1>üîß Functional Regression Test</h1>
    <p>Comprehensive testing to ensure all existing Prompt-Library dashboard features remain fully operational after zen-home integration.</p>
    
    <div class="test-container">
        <h2>üìã Automated Regression Tests</h2>
        <div id="test-results"></div>
        <button class="test-button" onclick="runRegressionTests()">üöÄ Run All Tests</button>
    </div>

    <div class="test-container">
        <h2>üéõÔ∏è Dashboard Feature Testing</h2>
        <p>Test each dashboard feature manually to ensure functionality is preserved:</p>
        
        <div class="feature-grid">
            <div class="feature-card">
                <h4>üè† Dashboard Core</h4>
                <a href="http://localhost:3001/dashboard" class="test-link auth-required" target="_blank">Dashboard Home</a>
                <p>Test: Overview widgets, recent activity, navigation menu</p>
            </div>
            
            <div class="feature-card">
                <h4>üìù Prompt Management</h4>
                <a href="http://localhost:3001/dashboard/prompts" class="test-link auth-required" target="_blank">Prompts Page</a>
                <p>Test: Create, edit, delete, search, filter prompts</p>
            </div>
            
            <div class="feature-card">
                <h4>‚ö° Prompt Execution</h4>
                <a href="http://localhost:3001/dashboard/executions" class="test-link auth-required" target="_blank">Executions Page</a>
                <p>Test: Execute prompts, view results, execution history</p>
            </div>
            
            <div class="feature-card">
                <h4>üìÑ Document Management</h4>
                <a href="http://localhost:3001/dashboard/documents" class="test-link auth-required" target="_blank">Documents Page</a>
                <p>Test: Upload, process, search documents for RAG</p>
            </div>
            
            <div class="feature-card">
                <h4>üìä Analytics</h4>
                <a href="http://localhost:3001/dashboard/analytics" class="test-link auth-required" target="_blank">Analytics Page</a>
                <p>Test: Usage metrics, performance data, charts</p>
            </div>
            
            <div class="feature-card">
                <h4>üë• Workspaces</h4>
                <a href="http://localhost:3001/dashboard/workspaces" class="test-link auth-required" target="_blank">Workspaces Page</a>
                <p>Test: Team collaboration, workspace management</p>
            </div>
            
            <div class="feature-card">
                <h4>üõí Marketplace</h4>
                <a href="http://localhost:3001/dashboard/marketplace" class="test-link auth-required" target="_blank">Marketplace Page</a>
                <p>Test: Browse templates, install prompts</p>
            </div>
            
            <div class="feature-card">
                <h4>‚öôÔ∏è Settings</h4>
                <a href="http://localhost:3001/dashboard/settings" class="test-link auth-required" target="_blank">Settings Page</a>
                <p>Test: User preferences, API keys, configuration</p>
            </div>
        </div>
    </div>

    <div class="test-container">
        <h2>üîê Authentication Testing</h2>
        <div class="feature-grid">
            <div class="feature-card">
                <h4>Login/Signup</h4>
                <a href="http://localhost:3001/auth" class="test-link" target="_blank">Authentication Page</a>
                <p>Test: Login, signup, password reset flows</p>
            </div>
            
            <div class="feature-card">
                <h4>Beta Program</h4>
                <a href="http://localhost:3001/beta-signup" class="test-link" target="_blank">Beta Signup</a>
                <p>Test: Beta registration process</p>
            </div>
        </div>
    </div>

    <div class="test-container">
        <h2>‚úÖ Manual Verification Checklist</h2>
        <ul class="checklist">
            <li><label><input type="checkbox"> Dashboard loads without errors</label></li>
            <li><label><input type="checkbox"> Navigation menu works correctly</label></li>
            <li><label><input type="checkbox"> Prompt creation and editing functional</label></li>
            <li><label><input type="checkbox"> Prompt execution works with AI models</label></li>
            <li><label><input type="checkbox"> Document upload and processing works</label></li>
            <li><label><input type="checkbox"> RAG functionality operational</label></li>
            <li><label><input type="checkbox"> Analytics dashboard displays data</label></li>
            <li><label><input type="checkbox"> Workspace management functional</label></li>
            <li><label><input type="checkbox"> Marketplace browsing works</label></li>
            <li><label><input type="checkbox"> Settings page saves preferences</label></li>
            <li><label><input type="checkbox"> Authentication flows work correctly</label></li>
            <li><label><input type="checkbox"> User sessions persist properly</label></li>
            <li><label><input type="checkbox"> Error handling works gracefully</label></li>
            <li><label><input type="checkbox"> Real-time features function correctly</label></li>
            <li><label><input type="checkbox"> Performance is acceptable</label></li>
        </ul>
    </div>

    <script>
        const testResults = document.getElementById('test-results');

        function addTestResult(message, type = 'success') {
            const div = document.createElement('div');
            div.className = `test-result ${type}`;
            div.textContent = message;
            testResults.appendChild(div);
        }

        async function testDashboardRoutes() {
            addTestResult('üîç Testing dashboard route accessibility...', 'warning');
            
            const dashboardRoutes = [
                { path: '/dashboard', name: 'Dashboard Home' },
                { path: '/dashboard/prompts', name: 'Prompts' },
                { path: '/dashboard/documents', name: 'Documents' },
                { path: '/dashboard/executions', name: 'Executions' },
                { path: '/dashboard/analytics', name: 'Analytics' },
                { path: '/dashboard/workspaces', name: 'Workspaces' },
                { path: '/dashboard/marketplace', name: 'Marketplace' },
                { path: '/dashboard/settings', name: 'Settings' }
            ];

            let accessibleCount = 0;
            let authRequiredCount = 0;
            let errorCount = 0;

            for (const route of dashboardRoutes) {
                try {
                    const response = await fetch(`http://localhost:3001${route.path}`);
                    
                    if (response.ok) {
                        addTestResult(`‚úÖ ${route.name} - Accessible (HTTP ${response.status})`, 'success');
                        accessibleCount++;
                    } else if (response.status === 401 || response.status === 403) {
                        addTestResult(`üîê ${route.name} - Auth Required (HTTP ${response.status})`, 'warning');
                        authRequiredCount++;
                    } else {
                        addTestResult(`‚ùå ${route.name} - Error (HTTP ${response.status})`, 'error');
                        errorCount++;
                    }
                } catch (error) {
                    addTestResult(`‚ùå ${route.name} - Network Error: ${error.message}`, 'error');
                    errorCount++;
                }
            }

            addTestResult(`üìä Dashboard Routes: ${accessibleCount} accessible, ${authRequiredCount} auth-protected, ${errorCount} errors`, 
                errorCount === 0 ? 'success' : 'warning');
        }

        async function testAPIEndpoints() {
            addTestResult('üåê Testing API endpoint accessibility...', 'warning');
            
            // Test basic API health (these might require auth)
            const apiTests = [
                { endpoint: '/api/health', name: 'Health Check' },
                { endpoint: '/api/prompts', name: 'Prompts API' },
                { endpoint: '/api/documents', name: 'Documents API' },
                { endpoint: '/api/executions', name: 'Executions API' }
            ];

            let healthyCount = 0;
            let authRequiredCount = 0;
            let errorCount = 0;

            for (const test of apiTests) {
                try {
                    const response = await fetch(`http://localhost:3001${test.endpoint}`);
                    
                    if (response.ok) {
                        addTestResult(`‚úÖ ${test.name} - Healthy`, 'success');
                        healthyCount++;
                    } else if (response.status === 401 || response.status === 403) {
                        addTestResult(`üîê ${test.name} - Auth Required`, 'warning');
                        authRequiredCount++;
                    } else {
                        addTestResult(`‚ö†Ô∏è ${test.name} - Status ${response.status}`, 'warning');
                        errorCount++;
                    }
                } catch (error) {
                    addTestResult(`‚ùå ${test.name} - Error: ${error.message}`, 'error');
                    errorCount++;
                }
            }

            addTestResult(`üìä API Endpoints: ${healthyCount} healthy, ${authRequiredCount} auth-protected, ${errorCount} issues`, 
                errorCount === 0 ? 'success' : 'warning');
        }

        async function testStaticAssets() {
            addTestResult('üñºÔ∏è Testing static asset loading...', 'warning');
            
            const criticalAssets = [
                '/vite.svg',
                '/assets/images/brain.svg',
                '/assets/marketing/images/ethosbrain.svg'
            ];

            let loadedCount = 0;
            let errorCount = 0;

            for (const asset of criticalAssets) {
                try {
                    const response = await fetch(`http://localhost:3001${asset}`);
                    if (response.ok) {
                        addTestResult(`‚úÖ Asset loaded: ${asset}`, 'success');
                        loadedCount++;
                    } else {
                        addTestResult(`‚ùå Asset failed: ${asset} - HTTP ${response.status}`, 'error');
                        errorCount++;
                    }
                } catch (error) {
                    addTestResult(`‚ùå Asset error: ${asset} - ${error.message}`, 'error');
                    errorCount++;
                }
            }

            addTestResult(`üìä Static Assets: ${loadedCount} loaded, ${errorCount} failed`, 
                errorCount === 0 ? 'success' : 'warning');
        }

        function testJavaScriptFeatures() {
            addTestResult('üîß Testing JavaScript features...', 'warning');
            
            // Test basic JavaScript functionality
            try {
                // Test localStorage
                localStorage.setItem('test', 'value');
                const testValue = localStorage.getItem('test');
                localStorage.removeItem('test');
                
                if (testValue === 'value') {
                    addTestResult('‚úÖ LocalStorage working', 'success');
                } else {
                    addTestResult('‚ùå LocalStorage not working', 'error');
                }
            } catch (error) {
                addTestResult(`‚ùå LocalStorage error: ${error.message}`, 'error');
            }

            // Test fetch API
            if (typeof fetch === 'function') {
                addTestResult('‚úÖ Fetch API available', 'success');
            } else {
                addTestResult('‚ùå Fetch API not available', 'error');
            }

            // Test modern JavaScript features
            try {
                const testAsync = async () => true;
                const testArrow = () => true;
                const testDestructuring = { a: 1 };
                const { a } = testDestructuring;
                
                addTestResult('‚úÖ Modern JavaScript features working', 'success');
            } catch (error) {
                addTestResult(`‚ùå Modern JavaScript error: ${error.message}`, 'error');
            }
        }

        async function runRegressionTests() {
            testResults.innerHTML = '';
            addTestResult('üöÄ Starting functional regression tests...', 'warning');
            
            await testDashboardRoutes();
            await testAPIEndpoints();
            await testStaticAssets();
            testJavaScriptFeatures();
            
            addTestResult('‚úÖ Regression tests completed!', 'success');
            addTestResult('üí° Use the dashboard links above to manually test each feature', 'warning');
            addTestResult('üìã Complete the manual verification checklist below', 'warning');
        }

        // Auto-run basic tests on load
        document.addEventListener('DOMContentLoaded', () => {
            addTestResult('‚úÖ Functional regression test page loaded', 'success');
            addTestResult('üí° Click "Run All Tests" to start automated testing', 'warning');
        });

        // Monitor for JavaScript errors
        window.addEventListener('error', (event) => {
            addTestResult(`‚ùå JavaScript Error: ${event.message} at ${event.filename}:${event.lineno}`, 'error');
        });

        window.addEventListener('unhandledrejection', (event) => {
            addTestResult(`‚ùå Unhandled Promise Rejection: ${event.reason}`, 'error');
        });
    </script>
</body>
</html>
